<!DOCTYPE html>

<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Caption Generator - Premium Features</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 40px; color: white; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        .header p { font-size: 1.2rem; opacity: 0.9; }
        .main-card { background: white; border-radius: 20px; padding: 40px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); margin-bottom: 40px; }

```
    /* Premium Banner */
    .premium-banner { background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); color: #333; text-align: center; padding: 15px; border-radius: 10px; margin-bottom: 20px; font-weight: 600; cursor: pointer; transition: transform 0.2s; }
    .premium-banner:hover { transform: translateY(-2px); }
    
    /* Usage Counter */
    .usage-counter { background: #ffe6e6; padding: 15px; border-radius: 8px; margin-bottom: 15px; font-size: 14px; color: #d63384; text-align: center; font-weight: bold; }
    
    /* Form Styles */
    .form-group { margin-bottom: 25px; }
    label { display: block; font-weight: 600; margin-bottom: 8px; color: #555; }
    input, textarea, select { width: 100%; padding: 15px; border: 2px solid #e1e5e9; border-radius: 10px; font-size: 16px; }
    textarea { min-height: 120px; }
    .form-row { display: grid; grid-template-columns: 1fr; gap: 20px; }
    @media (min-width: 768px) { .form-row { grid-template-columns: 1fr 1fr; } }
    
    .generate-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 15px 40px; font-size: 18px; font-weight: 600; border-radius: 50px; cursor: pointer; width: 100%; margin: 20px 0; }
    .generate-btn:disabled { opacity: 0.7; cursor: not-allowed; }
    .generate-btn.limited { background: #dc3545; }
    
    .results { background: #f8f9fa; border-radius: 15px; padding: 30px; margin-top: 30px; display: none; }
    .results.show { display: block; }
    .caption-result { background: white; border-radius: 10px; padding: 20px; margin-bottom: 15px; border-left: 4px solid #667eea; }
    .caption-result h4 { color: #667eea; margin-bottom: 10px; font-size: 14px; }
    .copy-btn { background: #28a745; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 12px; }
    
    .loading { display: none; text-align: center; padding: 20px; }
    .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 10px; }
    @keyframes spin { 0% { transform: rotate(0deg) } 100% { transform: rotate(360deg) } }
    
    /* FIXED Modal Styles for Mobile */
    .modal { 
        display: none; 
        position: fixed; 
        z-index: 1000; 
        left: 0; 
        top: 0; 
        width: 100%; 
        height: 100%; 
        background: rgba(0,0,0,0.8);
        overflow-y: auto; /* Allow scrolling */
    }
    
    .modal-content { 
        background: white; 
        margin: 20px auto; /* Smaller margin for mobile */
        padding: 20px; /* Smaller padding for mobile */
        border-radius: 20px; 
        width: 95%; /* Wider for mobile */
        max-width: 500px; 
        position: relative;
        max-height: 90vh; /* Limit height */
        overflow-y: auto; /* Scrollable content */
    }
    
    .close { position: absolute; right: 15px; top: 10px; font-size: 24px; cursor: pointer; color: #aaa; z-index: 1001; }
    .close:hover { color: #333; }
    
    /* Compact Pricing Cards for Mobile */
    .pricing-section { display: grid; grid-template-columns: 1fr; gap: 15px; margin: 20px 0; }
    @media (min-width: 768px) { .pricing-section { grid-template-columns: 1fr 1fr; gap: 20px; } }
    
    .pricing-card { 
        background: #f8f9fa; 
        border-radius: 15px; 
        padding: 20px; 
        text-align: center; 
        border: 2px solid #e1e5e9; 
        position: relative;
    }
    .pricing-card.popular { border-color: #ffd700; }
    .popular-badge { 
        position: absolute; 
        top: -10px; 
        left: 50%; 
        transform: translateX(-50%); 
        background: #ffd700; 
        color: #333; 
        padding: 5px 15px; 
        border-radius: 20px; 
        font-size: 12px; 
        font-weight: bold; 
    }
    
    .plan-name { font-size: 1.3rem; font-weight: bold; margin-bottom: 10px; margin-top: 10px; }
    .plan-price { font-size: 2rem; font-weight: bold; color: #667eea; margin-bottom: 5px; }
    .plan-period { color: #666; margin-bottom: 15px; font-size: 14px; }
    
    .features { list-style: none; margin-bottom: 20px; text-align: left; font-size: 14px; }
    .features li { padding: 6px 0; color: #555; }
    .features li:before { content: "✅ "; color: #28a745; }
    
    .subscribe-btn { 
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
        color: white; 
        border: none; 
        padding: 12px 20px; 
        border-radius: 25px; 
        font-size: 14px; 
        font-weight: bold; 
        cursor: pointer; 
        width: 100%; 
        margin-top: 10px;
    }
    .subscribe-btn:hover { transform: translateY(-1px); }
    
    /* Compact Payment Form */
    .payment-form { margin-top: 20px; }
    .payment-form h3 { font-size: 1.2rem; margin-bottom: 15px; text-align: center; }
    
    .security-info { background: #e8f5e8; padding: 12px; border-radius: 8px; margin: 15px 0; font-size: 12px; color: #155724; text-align: center; }
    
    .form-group-payment { margin-bottom: 15px; }
    .form-group-payment label { font-size: 14px; margin-bottom: 5px; }
    .form-group-payment input { padding: 12px; font-size: 14px; }
    
    .payment-btn { 
        background: #28a745; 
        color: white; 
        border: none; 
        padding: 15px; 
        border-radius: 8px; 
        font-size: 16px; 
        font-weight: bold; 
        cursor: pointer; 
        width: 100%; 
        margin-top: 15px; 
    }
    .payment-btn:disabled { opacity: 0.7; cursor: not-allowed; }
    
    /* Mobile optimizations */
    @media (max-width: 480px) {
        .modal-content { 
            margin: 10px; 
            width: calc(100% - 20px);
            padding: 15px;
        }
        .plan-price { font-size: 1.8rem; }
        .plan-name { font-size: 1.2rem; }
    }
</style>
```

</head>
<body>
    <!-- IMPROVED Subscription Modal -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>

```
        <div style="text-align: center; margin-bottom: 20px; padding-top: 10px;">
            <h2 style="font-size: 1.5rem; margin-bottom: 10px;">🚀 Choose Your Plan</h2>
            <p style="color: #666; font-size: 14px;">Unlock unlimited captions and premium features</p>
        </div>
        
        <div class="pricing-section">
            <div class="pricing-card">
                <div class="plan-name">Monthly Plan</div>
                <div class="plan-price">$9.99</div>
                <div class="plan-period">per month</div>
                <ul class="features">
                    <li>Unlimited captions</li>
                    <li>All platforms supported</li>
                    <li>Premium templates</li>
                    <li>Priority support</li>
                    <li>Cancel anytime</li>
                </ul>
                <button class="subscribe-btn" onclick="selectPlan('monthly', 999)">Choose Monthly</button>
            </div>
            
            <div class="pricing-card popular">
                <div class="popular-badge">🔥 SAVE 17%</div>
                <div class="plan-name">Yearly Plan</div>
                <div class="plan-price">$99.99</div>
                <div class="plan-period">per year</div>
                <ul class="features">
                    <li>Everything in Monthly</li>
                    <li>2 months FREE</li>
                    <li>Advanced analytics</li>
                    <li>API access</li>
                    <li>Custom branding</li>
                </ul>
                <button class="subscribe-btn" onclick="selectPlan('yearly', 9999)">Choose Yearly</button>
            </div>
        </div>
        
        <!-- Compact Payment Form -->
        <div id="paymentForm" class="payment-form" style="display: none;">
            <h3>Complete Your Purchase</h3>
            
            <div class="security-info">
                🔒 Secure payment • SSL encrypted • Cancel anytime
            </div>
            
            <div class="form-group-payment">
                <label>Email Address</label>
                <input type="email" id="email" placeholder="your@email.com" required>
            </div>
            
            <div class="form-group-payment">
                <label>Full Name</label>
                <input type="text" id="fullName" placeholder="John Doe" required>
            </div>
            
            <div class="form-group-payment">
                <label>Card Number</label>
                <input type="text" id="cardNumber" placeholder="4242 4242 4242 4242" maxlength="19">
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div class="form-group-payment">
                    <label>Expiry Date</label>
                    <input type="text" id="expiry" placeholder="MM/YY" maxlength="5">
                </div>
                <div class="form-group-payment">
                    <label>CVC</label>
                    <input type="text" id="cvc" placeholder="123" maxlength="4">
                </div>
            </div>
            
            <button id="submit-payment" class="payment-btn">
                🔒 Complete Payment
            </button>
            
            <p style="text-align: center; font-size: 11px; color: #666; margin-top: 10px;">
                30-day money-back guarantee • Cancel anytime
            </p>
        </div>
    </div>
</div>

<div class="container">
    <div class="header">
        <h1>🚀 AI Caption Generator</h1>
        <p>Create engaging social media captions</p>
    </div>
    
    <div class="main-card">
        <div class="premium-banner" onclick="showModal()">
            ⭐ Upgrade to Premium - Unlimited captions + Advanced features!
        </div>
        
        <div class="usage-counter" id="usageCounter">
            🚨 FREE LIMIT: <span id="usageCount">2/3</span> uses remaining today. <a href="#" onclick="showModal()" style="color: #dc3545; font-weight: bold;">Upgrade now!</a>
        </div>
        
        <form id="captionForm">
            <div class="form-group">
                <label for="topic">What's your post about?</label>
                <textarea id="topic" placeholder="Describe your post content..." required></textarea>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="platform">Platform</label>
                    <select id="platform" required>
                        <option value="">Select Platform</option>
                        <option value="instagram">Instagram</option>
                        <option value="facebook">Facebook</option>
                        <option value="twitter">Twitter</option>
                        <option value="linkedin">LinkedIn</option>
                        <option value="tiktok">TikTok</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="tone">Style</label>
                    <select id="tone" required>
                        <option value="">Select Style</option>
                        <option value="professional">Professional</option>
                        <option value="casual">Casual</option>
                        <option value="funny">Funny</option>
                        <option value="inspirational">Inspirational</option>
                        <option value="sales">Sales</option>
                    </select>
                </div>
            </div>
            
            <button type="submit" class="generate-btn" id="generateBtn">
                ✨ Generate Captions
            </button>
        </form>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Creating captions...</p>
        </div>
        
        <div class="results" id="results">
            <h3>🎉 Your Generated Captions:</h3>
            <div id="captionsContainer"></div>
            
            <!-- Upgrade prompt after results -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px; text-align: center; margin-top: 20px;">
                <h3>🚀 Want More Captions?</h3>
                <p style="margin: 10px 0;">Get unlimited access to our premium caption library</p>
                <button onclick="showModal()" style="background: white; color: #667eea; border: none; padding: 10px 20px; border-radius: 25px; font-weight: bold; cursor: pointer;">
                    Upgrade to Premium
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    let selectedPlan = null;
    let selectedPrice = null;

    class CaptionGenerator {
        constructor() {
            this.form = document.getElementById('captionForm');
            this.loading = document.getElementById('loading');
            this.results = document.getElementById('results');
            this.captionsContainer = document.getElementById('captionsContainer');
            this.usageCount = this.getUsageCount();
            this.maxFreeUses = 3;
            this.isPremium = this.checkPremiumStatus();
            
            this.updateUsageDisplay();
            this.init();
            
            // Show upgrade modal after 30 seconds for free users
            if (!this.isPremium) {
                setTimeout(() => showModal(), 30000);
            }
        }

        init() {
            this.form.addEventListener('submit', this.handleSubmit.bind(this));
        }

        checkPremiumStatus() {
            return localStorage.getItem('premiumUser') === 'true';
        }

        getUsageCount() {
            const saved = localStorage.getItem('captionUsage');
            if (saved) {
                const data = JSON.parse(saved);
                const today = new Date().toDateString();
                if (data.date === today) {
                    return data.count;
                }
            }
            return 0;
        }

        saveUsageCount(count) {
            const data = {
                date: new Date().toDateString(),
                count: count
            };
            localStorage.setItem('captionUsage', JSON.stringify(data));
        }

        updateUsageDisplay() {
            if (this.isPremium) {
                document.getElementById('usageCounter').innerHTML = '⭐ <strong>Premium Member</strong> - Unlimited captions available!';
                document.getElementById('usageCounter').style.background = '#d4f4dd';
                document.getElementById('usageCounter').style.color = '#0d7f2a';
                return;
            }
            
            const remaining = Math.max(0, this.maxFreeUses - this.usageCount);
            document.getElementById('usageCount').textContent = `${remaining}/${this.maxFreeUses}`;
            
            if (remaining === 0) {
                document.getElementById('generateBtn').textContent = '🔒 Daily limit reached - Upgrade to continue!';
                document.getElementById('generateBtn').classList.add('limited');
                document.getElementById('generateBtn').onclick = () => showModal();
            }
        }

        async handleSubmit(e) {
            e.preventDefault();
            
            if (!this.isPremium && this.usageCount >= this.maxFreeUses) {
                showModal();
                return;
            }
            
            const formData = new FormData(this.form);
            const data = {
                topic: formData.get('topic'),
                platform: formData.get('platform'),
                tone: formData.get('tone')
            };

            this.showLoading(true);
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            const captions = this.generateCaptions(data);
            this.displayResults(captions);
            
            if (!this.isPremium) {
                this.usageCount++;
                this.saveUsageCount(this.usageCount);
                this.updateUsageDisplay();
                
                // Show upgrade modal after 2nd use
                if (this.usageCount >= 2) {
                    setTimeout(() => showModal(), 5000);
                }
            }
            
            this.showLoading(false);
        }

        generateCaptions(data) {
            const templates = {
                casual: [
                    `Just had to share this! ${data.topic} 😍\n\nHonestly, this made my day. Who else loves this?\n\n#motivation #success`,
                    `Can we talk about ${data.topic}? 🗣️\n\nI'm obsessed and I'm not sorry about it! Drop a ❤️ if you agree.\n\n#lifestyle #goals`,
                    `Sunday vibes with ${data.topic} ☀️\n\nSometimes the simple things bring joy. What's making you smile today?\n\n#inspiration #happiness`
                ],
                professional: [
                    `${data.topic} 💼\n\nSharing insights on ${data.topic}. What are your thoughts? Let me know in comments.\n\n#business #professional`,
                    `Today's focus: ${data.topic} ✨\n\nConsistency and dedication are key to success. How do you stay motivated?\n\n#leadership #growth`,
                    `${data.topic} - a game changer in today's market. 📊\n\nSwipe to learn more about why this matters.\n\n#innovation #strategy`
                ],
                funny: [
                    `Me: I don't need ${data.topic}\nAlso me: *gets ${data.topic}* 😂\n\nWhy am I like this? Anyone else relate?\n\n#funny #relatable`,
                    `${data.topic} hit different today 🤪\n\nI'm not sure what I expected, but it wasn't this. Send help! 😅\n\n#humor #life`,
                    `Plot twist: ${data.topic} was actually worth the hype 🎭\n\nColor me surprised! What surprised you recently?\n\n#surprised #funny`
                ],
                inspirational: [
                    `Every journey starts with a single step. 🌟\n\n${data.topic} reminded me that progress isn't always linear.\n\n#motivation #journey`,
                    `Grateful for ${data.topic} today 🙏\n\nSometimes the universe gives us exactly what we need. Trust the process.\n\n#gratitude #trust`,
                    `Your only limit is your mindset. 💭\n\n${data.topic} taught me that challenges are opportunities in disguise.\n\n#mindset #growth`
                ],
                sales: [
                    `🔥 Special offer alert! ${data.topic}\n\nLimited time only - don't miss out! Link in bio for details.\n\n#sale #limited`,
                    `Why choose ${data.topic}? Let me tell you... ✨\n\n✅ Quality guaranteed\n✅ Fast delivery\n✅ Happy customers\n\nReady to try? DM us!\n\n#quality #service`,
                    `Customer favorite: ${data.topic} 🏆\n\n"Best purchase I've made this year!" - Sarah M.\n\nWhat are you waiting for?\n\n#testimonial #bestseller`
                ]
            };

            const tone = data.tone || 'casual';
            const selectedTemplates = templates[tone] || templates.casual;
            const captions = [];

            // Show fewer captions for free users
            const captionCount = this.isPremium ? 3 : 2;
            
            selectedTemplates.slice(0, captionCount).forEach((template, index) => {
                captions.push({
                    id: index + 1,
                    text: template.trim(),
                    platform: data.platform,
                    tone: tone
                });
            });

            return captions;
        }

        displayResults(captions) {
            this.captionsContainer.innerHTML = '';
            
            captions.forEach(caption => {
                const captionEl = document.createElement('div');
                captionEl.className = 'caption-result';
                captionEl.innerHTML = `
                    <h4>Version ${caption.id} - ${caption.tone} Style</h4>
                    <div style="line-height:1.6;margin-bottom:15px">${caption.text.replace(/\n/g, '<br>')}</div>
                    <button class="copy-btn" onclick="copyCaption(this, '${caption.text.replace(/'/g, "\\'")}')">📋 Copy Caption</button>
                `;
                this.captionsContainer.appendChild(captionEl);
            });

            this.results.classList.add('show');
            this.results.scrollIntoView({ behavior: 'smooth' });
        }

        showLoading(show) {
            this.loading.style.display = show ? 'block' : 'none';
            if (show) {
                this.results.classList.remove('show');
            }
        }
    }

    function copyCaption(btn, text) {
        navigator.clipboard.writeText(text).then(() => {
            btn.textContent = '✅ Copied!';
            setTimeout(() => {
                btn.textContent = '📋 Copy Caption';
            }, 2000);
        });
    }

    function showModal() {
        document.getElementById('subscriptionModal').style.display = 'block';
        // Prevent body scroll when modal is open
        document.body.style.overflow = 'hidden';
    }

    function closeModal() {
        document.getElementById('subscriptionModal').style.display = 'none';
        document.getElementById('paymentForm').style.display = 'none';
        // Restore body scroll
        document.body.style.overflow = 'auto';
    }

    function selectPlan(plan, price) {
        selectedPlan = plan;
        selectedPrice = price;
        
        // Show payment form
        document.getElementById('paymentForm').style.display = 'block';
        
        // Scroll to payment form
        document.getElementById('paymentForm').scrollIntoView({ behavior: 'smooth' });
    }

    // Format card number input
    document.addEventListener('DOMContentLoaded', function() {
        const captionGenerator = new CaptionGenerator();
        
        // Card number formatting
        document.getElementById('cardNumber').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\s/g, '').replace(/\D/g, '');
            value = value.replace(/(\d{4})/g, '$1 ').trim();
            e.target.value = value;
        });
        
        // Expiry date formatting
        document.getElementById('expiry').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
            e.target.value = value;
        });
        
        // CVC numeric only
        document.getElementById('cvc').addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/\D/g, '').substring(0, 4);
        });
        
        // Handle payment
        document.getElementById('submit-payment').addEventListener('click', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const fullName = document.getElementById('fullName').value;
            const cardNumber = document.getElementById('cardNumber').value;
            const expiry = document.getElementById('expiry').value;
            const cvc = document.getElementById('cvc').value;
            
            if (!email || !fullName || !cardNumber || !expiry || !cvc) {
                alert('Please fill in all fields');
                return;
            }
            
            const btn = e.target;
            btn.textContent = '⏳ Processing Payment...';
            btn.disabled = true;
            
            // Simulate payment processing
            setTimeout(() => {
                // Simulate successful payment
                localStorage.setItem('premiumUser', 'true');
                localStorage.setItem('userEmail', email);
                localStorage.setItem('subscriptionPlan', selectedPlan);
                
                alert(`🎉 Welcome to Premium! You now have unlimited access to all features!\n\nPlan: ${selectedPlan}\nThank you for your purchase!`);
                
                closeModal();
                location.reload(); // Refresh to show premium features
            }, 2000);
        });
    });

    // Close modal when clicking outside
    window.onclick = function(event) {
        const modal = document.getElementById('subscriptionModal');
        if (event.target === modal) {
            closeModal();
        }
    }
</script>
```

</body>
</html>
